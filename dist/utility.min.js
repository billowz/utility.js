!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("utility",e):t.utility=e()}(this,function(){function t(t){var e=(new Date).getTime(),n=Math.max(0,16-(e-W)),r=setTimeout(function(){t(e+n)},n);return W=e+n,r}function e(t){clearTimeout(t)}function n(t,e,n){t.prototype[e]||(t.prototype[e]=n)}function r(t){f(t)&&(nt=t)}function i(){return nt}function o(t,e){return nt.call(t,e)}function a(t){if(null===t||void 0===t)return!0;var e=et.call(t);switch(e){case at:case ct:case ut:case ot:return!0}return!1}function c(t){return void 0!==t}function s(t){return null===t}function u(t){return void 0===t||null===t}function l(t){return et.call(t)===it}function f(t){return et.call(t)===ot}function h(t){return et.call(t)===ct}function p(t){return et.call(t)===at}function d(t){return et.call(t)===st}function v(t){return et.call(t)===ut}function g(t){return et.call(t)===lt}function m(t){return et.call(t)===ft}function _(t){var e=et.call(t);switch(e){case rt:case it:case ut:case ht:return!0;default:if(t){var n=t.length;return h(n)&&(n?n>0&&n-1 in t:0===n)}return!1}}function y(t,e,n,r){var i=void 0,a=void 0;n=n||t;for(i in t)if(a=o(t,i),(r===!1||a)&&e.call(n,t[i],i,t,a)===!1)return!1;return!0}function b(t,e,n){var r=0,i=t.length;for(n=n||t;r<i;r++)if(e.call(n,t[r],r,t,!0)===!1)return!1;return!0}function w(t,e,n,r){return _(t)?b(t,e,n):!!u(t)||y(t,e,n,r)}function j(t,e,n,r){function i(t,n){o[n]=e.apply(this,arguments)}var o=void 0;return _(t)?(o=[],b(t,i,n)):(o={},u(t)||y(t,i,n,r)),o}function x(t,e,n,r){var i=void 0;return _(t)?(i=[],b(t,function(t){e.apply(this,arguments)&&i.push(t)},n)):(i={},u(t)||y(t,function(t,n){e.apply(this,arguments)&&(i[n]=t)},n,r)),i}function O(t,e,n,r,i){var o=n;return w(t,function(t,n,r,i){o=e.call(this,o,t,n,r,i)},r,i),o}function $(t,e,n,r){var i=[];return w(t,function(t,n){e&&!e.apply(this,arguments)||i.push(n)},n,r),i}function A(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}function k(t,e){for(var n=t.length;n-- >0;)if(t[n]===e)return n}function C(t,e,n){for(key in t)if((n===!1||o(t,key))&&t[key]===e)return key}function F(t,e,n){return _(t)?A(t,e):C(t,e,n)}function z(t,e,n){return _(t)?k(t,e):C(t,e,n)}function E(t,e,n,r,i){var o={};return w(t,function(t,r){o[e?e.apply(this,arguments):r]=n?n.apply(this,arguments):t},r,i),o}function L(t,e,n,r){var i={};return w(t,function(t,n){i[t]=e?e.apply(this,arguments):n},n,r),i}function N(t){return t.toUpperCase()}function P(t){return t.replace(pt,N)}function T(t){return t.replace(dt,"")}function M(t){return t.replace(vt,"")}function D(t){return t.replace(gt,"")}function S(t){var e=(t+"").split(".");return e[0]=e[0].replace(mt,"$1,"),e.join(".")}function q(t){for(var e=void 0,n=0;n<4;n++)if(e=_t[n],e.reg.test(t))return t.replace(e.reg,e.rep);return t}function Z(t){for(var e=void 0,n=0;n<4;n++)if(e=yt[n],e.reg.test(t))return t.replace(e.reg,e.rep);return t}function I(t,e){if(l(t))return t;if(!v(t))return[];var n=function(){var n=bt[t];return n?{v:n}:(n=e?bt[t]=[]:[],t.replace(wt,function(t,e,r,i){n.push(r?i.replace(jt,"$1"):e||t)}),{v:n})}();return"object"==typeof n?n.v:void 0}function R(t,e,n,r,i){for(var a=0,c=I(e,!0),s=c.length-1,l=void 0;!u(t)&&a<s;){if(l=c[a++],i&&!o(t,l))return n;t=t[l]}return l=c[a],a==s&&!u(t)&&(i?o(t,l):l in t)?t[l]:n}function H(t,e,n,r){for(var i=0,a=I(e,!0),c=a.length-1,s=void 0;!u(t)&&i<c;){if(s=a[i++],r&&!o(t,s))return!1;t=t[s]}return s=a[i],i==c&&!u(t)&&(r?o(t,s):s in t)}function K(t,e,n){for(var r=0,i=I(e,!0),o=i.length-1,a=i[0],c=t;r<o;r++)c=u(c[a])?c[a]={}:c[a],a=i[r+1];return c[a]=n,t}function U(t,e){return o(t,e)?t[e]:void 0}function G(t){for(var e=void 0,n=void 0,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(n in e)o(e,n)&&!o(t,n)&&(t[n]=e[n])}return t}function X(){}function B(t,e){if(!f(t))return t instanceof e;for(var n=t;(n=xt(n))&&n!==Object;)if(n===e)return!0;return e===Object}function Y(t){var e=function(){this.constructor.apply(this,arguments)},n=t.extend,r=void 0,i=void 0;return $t(e,kt),f(n)&&n!==Object||(n=kt),r=n.prototype,i=At(r),e.superclass=r,e.prototype=i,Ot(e,n),delete t.extend,e.extend(t)}function J(t,e,n,r){var i=t.length,o=i>=e?"":Array(1+e-i>>>0).join(n);return r?t+o:o+t}function Q(t,e){function n(t){return t=t?"*"==t?+e[i++]:"$"==t?+e[i]:"$"==t.charAt(t.length-1)?+e[t.slice(0,-1)-1]:+t:0,isFinite(t)?t<0?0:t:0}function r(t){return t&&"*"!=t?"$"==t?e[i]:e[t.slice(0,-1)-1]:e[i++]}var i=0;return t=t.replace(Et,function(t,e,i,o,a,c){if("%"===c)return"%";var s=r(e);o=n(o),a=a&&n(a.slice(1)),a||0===a||(a="fFeE".indexOf(c)==-1?"d"==c?0:void 0:6),console.log("match:"+t+", index:"+e+"/"+s+", flags:"+i+", width:"+o+", prec:"+a+", type:"+c);var l=!1,f="",h=!1,p=!1,d=!1,v=void 0,g=void 0;switch(i&&w(i,function(t){switch(t){case" ":case"+":f=t;break;case"-":l=!0;break;case"0":h=!0;break;case"#":p=!0;break;case",":d=!0}}),c){case"c":return String.fromCharCode(+s);case"s":return u(s)&&!isNaN(s)?"":(s+="",a&&s.length>a&&(s=s.slice(0,a)),s.length<o&&(s=J(s,o,h?"0":" ",!1)),s);case"d":return s=parseInt(s),isNaN(s)?"":(s<0?(v="-",s=-s):v=f,s+="",s.length<o&&(s=J(s,o,"0",!1)),d&&(s=s.replace(Lt,"$1,")),v+s);case"e":case"E":case"f":case"g":case"G":case"p":case"P":var m=+s;if(isNaN(m))return"";m<0?(v="-",m=-m):v=f;var _=void 0,y=c.toLowerCase();if("p"!=y)_=["toExponential","toFixed","toPrecision"]["efg".indexOf(y)];else{var b=String(s).replace(/[eE].*|[^\d]/g,"");b=(m?b.replace(/^0+/,""):b).length,a&&(a=Math.min(a,b)),_=!a||a<=b?"toPrecision":"toExponential"}if(m=m[_](a),m.length<o&&(m=J(m,o,"0",!1)),d){var j=m.split(".");j[0]=j[0].replace(Lt,"$1,"),m=j.join(".")}return s=v+m,"EGP".indexOf(c)!=-1?s.toUpperCase():s;case"b":g=2;break;case"o":g=8;break;case"u":g=10;break;case"x":case"X":g=16;break;case"n":return"";default:return t}var x=s>>>0;return v=p&&10!=g&&x&&["0b","0","0x"][g>>3]||"",x=x.toString(g),x.length<o&&(x=J(x,o,"0",!1)),s=v+x,"X"==c?s.toUpperCase():s}),{format:t,count:i}}function V(t){return Q(t,Array.prototype.slice.call(arguments,1)).format}var W=void 0,tt={request:t,cancel:e};window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||tt.request,window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||tt.cancel,n(Function,"bind",function(t){var e=this,n=Array.prototype.slice.call(arguments,1);return function(){return e.apply(t,n.concat(Array.prototype.slice.call(arguments)))}}),Object.freeze||(Object.freeze=function(t){return t});var et=Object.prototype.toString,nt=Object.prototype.hasOwnProperty,rt="[object Arguments]",it="[object Array]",ot="[object Function]",at="[object Boolean]",ct="[object Number]",st="[object Date]",ut="[object String]",lt="[object Object]",ft="[object RegExp]",ht="[object NodeList]",pt=/^[a-z]/,dt=/^\s+/,vt=/\s+$/,gt=/(^\s+)|(\s+$)/g,mt=/(\d)(?=(\d{3})+(?!\d))/g,_t=[{reg:/([a-zA-Z]+[^aeiou])y$/,rep:"$1ies"},{reg:/([a-zA-Z]+[aeiou]y)$/,rep:"$1s"},{reg:/([a-zA-Z]+[sxzh])$/,rep:"$1es"},{reg:/([a-zA-Z]+[^sxzhy])$/,rep:"$1s"}],yt=[{reg:/([a-zA-Z]+[^aeiou])ies$/,rep:"$1y"},{reg:/([a-zA-Z]+[aeiou])s$/,rep:"$1"},{reg:/([a-zA-Z]+[sxzh])es$/,rep:"$1"},{reg:/([a-zA-Z]+[^sxzhy])s$/,rep:"$1"}],bt={},wt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,jt=/\\(\\)?/g,xt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__},Ot=Object.setPrototypeOf||function(t,e){t.__proto__=e},$t=Object.assign||function(t){for(var e=void 0,n=void 0,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(n in e)o(e,n)&&(t[n]=e[n])}return t},At=Object.create||function(t,e){X.prototype=t;var n=new X;return X.prototype=void 0,e&&w(e,function(t,e){n[e]=t.value}),n},kt=function(){},Ct=[];$t(kt.prototype,{super:function(t){var e=arguments.callee.caller;e.$owner.superclass[e.$name].apply(this,t||Ct)},superclass:function(){var t=arguments.callee.caller;return t.$owner.superclass}}),$t(kt,{extend:function(t){var e=this;return t&&!function(){var n=e.prototype;w(t,function(t,r){f(t)&&(t.$owner=e,t.$name=r),n[r]=t}),e.assign(t.statics)}(),this},assign:function(t){return t&&$t(this,t),this}});var Ft=Object.freeze({overrideHasOwnProlicy:r,hasOwnProlicy:i,hasOwnProp:o,isPrimitive:a,isDefine:c,isNull:s,isNil:u,isArray:l,isFunc:f,isNumber:h,isBool:p,isDate:d,isString:v,isObject:g,isRegExp:m,isArrayLike:_,each:w,map:j,filter:x,aggregate:O,keys:$,indexOf:F,lastIndexOf:z,convert:E,reverseConvert:L,upperFirst:P,ltrim:T,rtrim:M,trim:D,thousandSeparate:S,plural:q,singular:Z,parseExpr:I,get:R,has:H,set:K,getOwnProp:U,prototypeOf:xt,setPrototypeOf:Ot,assign:$t,assignIf:G,emptyFunc:X,create:At,isExtendOf:B,dynamicClass:Y}),zt=Y({constructor:function(t){this.cfg=t||{}},register:function(t,e){var n=this;return 1==arguments.length?w(t,function(t,e){n.cfg[e]=t}):this.cfg[t]=e,this},config:function(t){var e=this;return t&&w(this.cfg,function(n,r){o(t,r)&&(e.cfg[r]=t[r])}),this},get:function(t){return arguments.length?this.cfg[t]:At(this.cfg)}}),Et=/%(\d+\$|\*|\$)?([-+#0, ]*)?(\d+\$?|\*|\$)?(\.\d+\$?|\.\*|\.\$)?([%sfducboxXeEgGpP])/g,Lt=/(\d)(?=(\d{3})+(?!\d))/g;V.format=Q;var Nt=["debug","info","warn","error"],Pt=document.createElement("div"),Tt=Array.prototype.slice,Mt=Y({constructor:function(){Pt.innerHTML='<div id="simulation_console"\n    style="position:absolute; top:0; right:0; font-family:courier,monospace; background:#eee; font-size:10px; padding:10px; width:200px; height:200px;">\n  <a style="float:right; padding-left:1em; padding-bottom:.5em; text-align:right;">Clear</a>\n  <div id="simulation_console_body"></div>\n</div>',this.el=Pt.childNodes[0],this.clearEl=this.el.childNodes[0],this.bodyEl=this.el.childNodes[1]},appendTo:function(t){t.appendChild(this.el)},log:function(t,e){Pt.innerHTML='<span style="'+t+'">'+e+"</span>",this.bodyEl.appendChild(Pt.childNodes[0])},parseMsg:function(t){var e=t[0];if(v(e)){var n=V.format.apply(null,t);return[n.format].concat(Tt.call(t,n.count)).join(" ")}return t.join(" ")},debug:function(){this.log("color: red;",this.parseMsg(arguments))},info:function(){this.log("color: red;",this.parseMsg(arguments))},warn:function(){this.log("color: red;",this.parseMsg(arguments))},error:function(){this.log("color: red;",this.parseMsg(arguments))},clear:function(){this.bodyEl.innerHTML=""}}),Dt=window.console;Dt&&!Dt.debug&&(Dt.debug=function(){Function.apply.call(Dt.log,Dt,arguments)});var St=Y({statics:{enableSimulationConsole:function(){Dt||(Dt=new Mt,Dt.appendTo(document.body))}},constructor:function(t,e){this.module=t,this.level=F(Nt,e||"info")},setLevel:function(t){this.level=F(Nt,t||"info")},getLevel:function(){return Nt[this.level]},_print:function(t,e,n){Function.apply.call(Dt[t],Dt,e),n&&Dt.trace&&Dt.trace()},_log:function(t,e,n){if(!(t<this.level)&&Dt){var r="[%s] %s -"+(v(e[0])?" "+e.shift():""),i=[];e=x(e,function(t){return!(t instanceof Error)||(i.push(t),!1)}),w(i,function(t){e.push.call(e,t.message,"\n",t.stack)}),t=Nt[t],this._print(t,[r,t,this.module].concat(e),n)}},debug:function(){this._log(0,Tt.call(arguments,0))},info:function(){this._log(1,Tt.call(arguments,0))},warn:function(){this._log(2,Tt.call(arguments,0))},error:function(){this._log(3,Tt.call(arguments,0))}});St.logger=new St("default","info");var qt=1,Zt=Y({statics:{ListKey:"__UTILITY_LIST__"},constructor:function(){this._id=qt++,this.length=0,this._header=void 0,this._tail=void 0,this._version=1},_listObj:function(t){return o(t,Zt.ListKey)&&t[Zt.ListKey]},_desc:function(t){var e=this._listObj(t);return e&&e[this._id]},_getOrCreateDesc:function(t){var e=this._listObj(t)||(t[Zt.ListKey]={}),n=e[this._id];return n||(e[this._id]={obj:t,prev:void 0,next:void 0,version:this._version++})},_unlink:function(t){var e=t.prev,n=t.next;e?e.next=n:this._header=n,n?n.prev=e:this._tail=e,this.length--},_move:function(t,e,n){var r=this._header;(r===t||t.prev)&&this._unlink(t),t.prev=e,e?(t.next=e.next,e.next=t):(t.next=r,r&&(r.prev=t),this._header=t),this._tail===e&&(this._tail=t),this.length++},_remove:function(t){var e=t.obj,n=this._listObj(e);this._unlink(t),delete n[this._id]},push:function(t){return this.last(t)},pop:function(){var t=this._header;if(t)return this._remove(t),t.obj},shift:function(){var t=this._tail;if(t)return this._remove(t),t.obj},first:function(t){if(0==arguments.length){var e=this._header;return e&&e.obj}return this._move(this._getOrCreateDesc(t),void 0),this},last:function(t){if(0==arguments.length){var e=this._tail;return e&&e.obj}return this._move(this._getOrCreateDesc(t),this._tail),this},before:function(t,e){if(1==arguments.length){var n=this._desc(t),r=n&&n.prev;return r&&r.obj}return this._move(this._getOrCreateDesc(t),this._desc(e).prev),this},after:function(t,e){if(1==arguments.length){var n=this._desc(t),r=n&&n.next;return r&&r.obj}return this._move(this._getOrCreateDesc(t),this._desc(e)),this},contains:function(t){return!!this._desc(t)},remove:function(t){var e=this._listObj(t),n=void 0;return!(!e||!(n=e[this._id]))&&(this._unlink(n),delete e[this._id],!0)},clean:function(){for(var t=this._header;t;)delete this._listObj(t.obj)[this._id],t=t.next;return this._header=void 0,this._tail=void 0,this.length=0,this},empty:function(){return 0==this.length},size:function(){return this.length},each:function(t,e){for(var n=this._header,r=this._version;n;){if(n.version<r&&t.call(e||this,n.obj,this)===!1)return!1;n=n.next}return!0},map:function(t,e){var n=this,r=[];return this.each(function(i){r.push(t.call(e||n,i,n))}),r},filter:function(t,e){var n=this,r=[];return this.each(function(i){t.call(e||n,i,n)&&r.push(i)}),r},toArray:function(){var t=[];return this.each(function(e){t.push(e)}),t}}),It=G({format:V,timeoutframe:tt,Configuration:zt,Logger:St,LinkedList:Zt},Ft);return It});
//# sourceMappingURL=utility.min.js.map