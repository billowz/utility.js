!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("utility",e):t.utility=e()}(this,function(){function t(t){var e=(new Date).getTime(),n=Math.max(0,16-(e-W)),r=setTimeout(function(){t(e+n)},n);return W=e+n,r}function e(t){clearTimeout(t)}function n(t,e,n){t.prototype[e]||(t.prototype[e]=n)}function r(t){f(t)&&(nt=t)}function i(){return nt}function o(t,e){return nt.call(t,e)}function c(t){if(null===t||void 0===t)return!0;var e=et.call(t);switch(e){case ct:case at:case ut:case ot:return!0}return!1}function a(t){return void 0!==t}function s(t){return null===t}function u(t){return void 0===t||null===t}function l(t){return et.call(t)===it}function f(t){return et.call(t)===ot}function h(t){return et.call(t)===at}function p(t){return et.call(t)===ct}function d(t){return et.call(t)===st}function v(t){return et.call(t)===ut}function g(t){return et.call(t)===lt}function m(t){return et.call(t)===ft}function _(t){var e=et.call(t);switch(e){case rt:case it:case ut:case ht:return!0;default:if(t){var n=t.length;return h(n)&&(n?n>0&&n-1 in t:0===n)}return!1}}function b(t,e,n,r){var i=void 0,c=void 0;n=n||t;for(i in t)if(c=o(t,i),(r===!1||c)&&e.call(n,t[i],i,t,c)===!1)return!1;return!0}function y(t,e,n){var r=0,i=t.length;for(n=n||t;r<i;r++)if(e.call(n,t[r],r,t,!0)===!1)return!1;return!0}function j(t,e,n,r){return _(t)?y(t,e,n):!!u(t)||b(t,e,n,r)}function w(t,e,n,r){function i(t,n){o[n]=e.apply(this,arguments)}var o=void 0;return _(t)?(o=[],y(t,i,n)):(o={},u(t)||b(t,i,n,r)),o}function O(t,e,n,r){var i=void 0;return _(t)?(i=[],y(t,function(t){e.apply(this,arguments)&&i.push(t)},n)):(i={},u(t)||b(t,function(t,n){e.apply(this,arguments)&&(i[n]=t)},n,r)),i}function x(t,e,n,r,i){var o=n;return j(t,function(t,n,r,i){o=e.call(this,o,t,n,r,i)},r,i),o}function $(t,e,n,r){var i=[];return j(t,function(t,n){e&&!e.apply(this,arguments)||i.push(n)},n,r),i}function A(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}function k(t,e){for(var n=t.length;n-- >0;)if(t[n]===e)return n}function C(t,e,n){for(key in t)if((n===!1||o(t,key))&&t[key]===e)return key}function F(t,e,n){return _(t)?A(t,e):C(t,e,n)}function E(t,e,n){return _(t)?k(t,e):C(t,e,n)}function L(t,e,n,r,i){var o={};return j(t,function(t,r){o[e?e.apply(this,arguments):r]=n?n.apply(this,arguments):t},r,i),o}function N(t,e,n,r){var i={};return j(t,function(t,n){i[t]=e?e.apply(this,arguments):n},n,r),i}function P(t){return t.toUpperCase()}function z(t){return t.replace(pt,P)}function T(t){return t.replace(dt,"")}function M(t){return t.replace(vt,"")}function D(t){return t.replace(gt,"")}function S(t){var e=(t+"").split(".");return e[0]=e[0].replace(mt,"$1,"),e.join(".")}function q(t){for(var e=void 0,n=0;n<4;n++)if(e=_t[n],e.reg.test(t))return t.replace(e.reg,e.rep);return t}function I(t){for(var e=0;e<4;e++)if(I=_t[e],I.reg.test(t))return t.replace(I.reg,I.rep);return t}function R(t,e){if(l(t))return t;if(!v(t))return[];var n=function(){var n=bt[t];return n?{v:n}:(n=e?bt[t]=[]:[],t.replace(yt,function(t,e,r,i){n.push(r?i.replace(jt,"$1"):e||t)}),{v:n})}();return"object"==typeof n?n.v:void 0}function H(t,e,n,r,i){for(var c=0,a=R(e,!0),s=a.length-1,l=void 0;!u(t)&&c<s;){if(l=a[c++],i&&!o(t,l))return n;t=t[l]}return l=a[c],c==s&&!u(t)&&(i?o(t,l):l in t)?t[l]:n}function K(t,e,n,r){for(var i=0,c=R(e,!0),a=c.length-1,s=void 0;!u(t)&&i<a;){if(s=c[i++],r&&!o(t,s))return!1;t=t[s]}return s=c[i],i==a&&!u(t)&&(r?o(t,s):s in t)}function U(t,e,n){for(var r=0,i=R(e,!0),o=i.length-1,c=i[0],a=t;r<o;r++)a=u(a[c])?a[c]={}:a[c],c=i[r+1];return a[c]=n,t}function Z(t,e){return o(t,e)?t[e]:void 0}function G(t){for(var e=void 0,n=void 0,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(n in e)o(e,n)&&!o(t,n)&&(t[n]=e[n])}return t}function X(){}function B(t,e){if(!f(t))return t instanceof e;for(var n=t;(n=wt(n))&&n!==Object;)if(n===e)return!0;return e===Object}function Y(t){var e=function(){this.constructor.apply(this,arguments)},n=t.extend,r=void 0,i=void 0;return xt(e,At),f(n)&&n!==Object||(n=At),r=n.prototype,i=$t(r),e.superclass=r,e.prototype=i,Ot(e,n),delete t.extend,e.extend(t)}function J(t,e,n,r){var i=t.length,o=i>=e?"":Array(1+e-i>>>0).join(n);return r?t+o:o+t}function Q(t,e){function n(t){return t=t?"*"==t?+e[i++]:"$"==t?+e[i]:"$"==t.charAt(t.length-1)?+e[t.slice(0,-1)-1]:+t:0,isFinite(t)?t<0?0:t:0}function r(t){return t&&"*"!=t?"$"==t?e[i]:e[t.slice(0,-1)-1]:e[i++]}var i=0;return t=t.replace(Et,function(t,e,i,o,c,a){if("%"===a)return"%";var s=r(e);o=n(o),c=c&&n(c.slice(1)),c||0===c||(c="fFeE".indexOf(a)==-1?"d"==a?0:void 0:6),console.log("match:"+t+", index:"+e+"/"+s+", flags:"+i+", width:"+o+", prec:"+c+", type:"+a);var l=!1,f="",h=!1,p=!1,d=!1,v=void 0,g=void 0;switch(i&&j(i,function(t){switch(t){case" ":case"+":f=t;break;case"-":l=!0;break;case"0":h=!0;break;case"#":p=!0;break;case",":d=!0}}),a){case"c":return String.fromCharCode(+s);case"s":return u(s)&&!isNaN(s)?"":(s+="",c&&s.length>c&&(s=s.slice(0,c)),s.length<o&&(s=J(s,o,h?"0":" ",!1)),s);case"d":return s=parseInt(s),isNaN(s)?"":(s<0?(v="-",s=-s):v=f,s+="",s.length<o&&(s=J(s,o,"0",!1)),d&&(s=s.replace(Lt,"$1,")),v+s);case"e":case"E":case"f":case"g":case"G":case"p":case"P":var m=+s;if(isNaN(m))return"";m<0?(v="-",m=-m):v=f;var _=void 0,b=a.toLowerCase();if("p"!=b)_=["toExponential","toFixed","toPrecision"]["efg".indexOf(b)];else{var y=String(s).replace(/[eE].*|[^\d]/g,"");y=(m?y.replace(/^0+/,""):y).length,c&&(c=Math.min(c,y)),_=!c||c<=y?"toPrecision":"toExponential"}if(m=m[_](c),m.length<o&&(m=J(m,o,"0",!1)),d){var w=m.split(".");w[0]=w[0].replace(Lt,"$1,"),m=w.join(".")}return s=v+m,"EGP".indexOf(a)!=-1?s.toUpperCase():s;case"b":g=2;break;case"o":g=8;break;case"u":g=10;break;case"x":case"X":g=16;break;case"n":return"";default:return t}var O=s>>>0;return v=p&&10!=g&&O&&["0b","0","0x"][g>>3]||"",O=O.toString(g),O.length<o&&(O=J(O,o,"0",!1)),s=v+O,"X"==a?s.toUpperCase():s}),{format:t,count:i}}function V(t){return Q(t,Array.prototype.slice.call(arguments,1)).format}var W=void 0,tt={request:t,cancel:e};window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||tt.request,window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||tt.cancel,n(Function,"bind",function(t){var e=this,n=Array.prototype.slice.call(arguments,1);return function(){return e.apply(t,n.concat(Array.prototype.slice.call(arguments)))}}),Object.freeze||(Object.freeze=function(t){return t});var et=Object.prototype.toString,nt=Object.prototype.hasOwnProperty,rt="[object Arguments]",it="[object Array]",ot="[object Function]",ct="[object Boolean]",at="[object Number]",st="[object Date]",ut="[object String]",lt="[object Object]",ft="[object RegExp]",ht="[object NodeList]",pt=/^[a-z]/,dt=/^\s+/,vt=/\s+$/,gt=/(^\s+)|(\s+$)/g,mt=/(\d)(?=(\d{3})+(?!\d))/g,_t=[{reg:/([a-zA-Z]+[^aeiou])y$/,rep:"$1ies"},{reg:/([a-zA-Z]+[aeiou]y)$/,rep:"$1s"},{reg:/([a-zA-Z]+[sxzh])$/,rep:"$1es"},{reg:/([a-zA-Z]+[^sxzhy])$/,rep:"$1s"}],bt={},yt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,jt=/\\(\\)?/g,wt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__},Ot=Object.setPrototypeOf||function(t,e){t.__proto__=e},xt=Object.assign||function(t){for(var e=void 0,n=void 0,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(n in e)o(e,n)&&(t[n]=e[n])}return t},$t=Object.create||function(t,e){X.prototype=t;var n=new X;return X.prototype=void 0,e&&j(e,function(t,e){n[e]=t.value}),n},At=function(){},kt=[];xt(At.prototype,{super:function(t){var e=arguments.callee.caller;e.$owner.superclass[e.$name].apply(this,t||kt)},superclass:function(){var t=arguments.callee.caller;return t.$owner.superclass}}),xt(At,{extend:function(t){var e=this;return t&&!function(){var n=e.prototype;j(t,function(t,r){f(t)&&(t.$owner=e,t.$name=r),n[r]=t}),e.assign(t.statics)}(),this},assign:function(t){return t&&xt(this,t),this}});var Ct=Object.freeze({overrideHasOwnProlicy:r,hasOwnProlicy:i,hasOwnProp:o,isPrimitive:c,isDefine:a,isNull:s,isNil:u,isArray:l,isFunc:f,isNumber:h,isBool:p,isDate:d,isString:v,isObject:g,isRegExp:m,isArrayLike:_,each:j,map:w,filter:O,aggregate:x,keys:$,indexOf:F,lastIndexOf:E,convert:L,reverseConvert:N,upperFirst:z,ltrim:T,rtrim:M,trim:D,thousandSeparate:S,plural:q,get singular(){return I},parseExpr:R,get:H,has:K,set:U,getOwnProp:Z,prototypeOf:wt,setPrototypeOf:Ot,assign:xt,assignIf:G,emptyFunc:X,create:$t,isExtendOf:B,dynamicClass:Y}),Ft=Y({constructor:function(t){this.cfg=t||{}},register:function(t,e){var n=this;return 1==arguments.length?j(t,function(t,e){n.cfg[e]=t}):this.cfg[t]=e,this},config:function(t){var e=this;return t&&j(this.cfg,function(n,r){o(t,r)&&(e.cfg[r]=t[r])}),this},get:function(t){return arguments.length?this.cfg[t]:$t(this.cfg)}}),Et=/%(\d+\$|\*|\$)?([-+#0, ]*)?(\d+\$?|\*|\$)?(\.\d+\$?|\.\*|\.\$)?([%sfducboxXeEgGpP])/g,Lt=/(\d)(?=(\d{3})+(?!\d))/g;V.format=Q;var Nt=["debug","info","warn","error"],Pt=document.createElement("div"),zt=Array.prototype.slice,Tt=Y({constructor:function(){Pt.innerHTML='<div id="simulation_console"\n    style="position:absolute; top:0; right:0; font-family:courier,monospace; background:#eee; font-size:10px; padding:10px; width:200px; height:200px;">\n  <a style="float:right; padding-left:1em; padding-bottom:.5em; text-align:right;">Clear</a>\n  <div id="simulation_console_body"></div>\n</div>',this.el=Pt.childNodes[0],this.clearEl=this.el.childNodes[0],this.bodyEl=this.el.childNodes[1]},appendTo:function(t){t.appendChild(this.el)},log:function(t,e){Pt.innerHTML='<span style="'+t+'">'+e+"</span>",this.bodyEl.appendChild(Pt.childNodes[0])},parseMsg:function(t){var e=t[0];if(v(e)){var n=V.format.apply(null,t);return[n.format].concat(zt.call(t,n.count)).join(" ")}return t.join(" ")},debug:function(){this.log("color: red;",this.parseMsg(arguments))},info:function(){this.log("color: red;",this.parseMsg(arguments))},warn:function(){this.log("color: red;",this.parseMsg(arguments))},error:function(){this.log("color: red;",this.parseMsg(arguments))},clear:function(){this.bodyEl.innerHTML=""}}),Mt=window.console;Mt&&!Mt.debug&&(Mt.debug=function(){Function.apply.call(Mt.log,Mt,arguments)});var Dt=Y({statics:{enableSimulationConsole:function(){Mt||(Mt=new Tt,Mt.appendTo(document.body))}},constructor:function(t,e){this.module=t,this.level=F(Nt,e||"info")},setLevel:function(t){this.level=F(Nt,t||"info")},getLevel:function(){return Nt[this.level]},_print:function(t,e,n){Function.apply.call(Mt[t],Mt,e),n&&Mt.trace&&Mt.trace()},_log:function(t,e,n){if(!(t<this.level)&&Mt){var r="[%s] %s -"+(v(e[0])?" "+e.shift():""),i=[];e=O(e,function(t){return!(t instanceof Error)||(i.push(t),!1)}),j(i,function(t){e.push.call(e,t.message,"\n",t.stack)}),t=Nt[t],this._print(t,[r,t,this.module].concat(e),n)}},debug:function(){this._log(0,zt.call(arguments,0))},info:function(){this._log(1,zt.call(arguments,0))},warn:function(){this._log(2,zt.call(arguments,0))},error:function(){this._log(3,zt.call(arguments,0))}});Dt.logger=new Dt("default","info");var St=1,qt=Y({statics:{ListKey:"__UTILITY_LIST__"},constructor:function(){this._id=St++,this.length=0,this._header=void 0,this._tail=void 0,this._version=1},_listObj:function(t){return o(t,qt.ListKey)&&t[qt.ListKey]},_desc:function(t){var e=this._listObj(t);return e&&e[this._id]},_getOrCreateDesc:function(t){var e=this._listObj(t)||(t[qt.ListKey]={}),n=e[this._id];return n||(e[this._id]={obj:t,prev:void 0,next:void 0,version:this._version++})},_unlink:function(t){var e=t.prev,n=t.next;e?e.next=n:this._header=n,n?n.prev=e:this._tail=e,this.length--},_move:function(t,e,n){var r=this._header;(r===t||t.prev)&&this._unlink(t),t.prev=e,e?(t.next=e.next,e.next=t):(t.next=r,r&&(r.prev=t),this._header=t),this._tail===e&&(this._tail=t),this.length++},_remove:function(t){var e=t.obj,n=this._listObj(e);this._unlink(t),delete n[this._id]},push:function(t){return this.last(t)},pop:function(){var t=this._header;if(t)return this._remove(t),t.obj},shift:function(){var t=this._tail;if(t)return this._remove(t),t.obj},first:function(t){if(0==arguments.length){var e=this._header;return e&&e.obj}return this._move(this._getOrCreateDesc(t),void 0),this},last:function(t){if(0==arguments.length){var e=this._tail;return e&&e.obj}return this._move(this._getOrCreateDesc(t),this._tail),this},before:function(t,e){if(1==arguments.length){var n=this._desc(t),r=n&&n.prev;return r&&r.obj}return this._move(this._getOrCreateDesc(t),this._desc(e).prev),this},after:function(t,e){if(1==arguments.length){var n=this._desc(t),r=n&&n.next;return r&&r.obj}return this._move(this._getOrCreateDesc(t),this._desc(e)),this},contains:function(t){return!!this._desc(t)},remove:function(t){var e=this._listObj(t),n=void 0;return!(!e||!(n=e[this._id]))&&(this._unlink(n),delete e[this._id],!0)},clean:function(){for(var t=this._header;t;)delete this._listObj(t.obj)[this._id],t=t.next;return this._header=void 0,this._tail=void 0,this.length=0,this},empty:function(){return 0==this.length},size:function(){return this.length},each:function(t,e){for(var n=this._header,r=this._version;n;){if(n.version<r&&t.call(e||this,n.obj,this)===!1)return!1;n=n.next}return!0},map:function(t,e){var n=this,r=[];return this.each(function(i){r.push(t.call(e||n,i,n))}),r},filter:function(t,e){var n=this,r=[];return this.each(function(i){t.call(e||n,i,n)&&r.push(i)}),r},toArray:function(){var t=[];return this.each(function(e){t.push(e)}),t}}),It=G({format:V,timeoutframe:tt,Configuration:Ft,Logger:Dt,LinkedList:qt},Ct);return It});
//# sourceMappingURL=utility.min.js.map